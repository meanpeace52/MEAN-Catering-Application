<div class="container">
  <div class="row">
    <div class="col-sm-12" ng-if="!vm.user.address">
      <h1>Your address is required</h1>
      Please, add you address via you profile.
    </div>
    <!--<div class="col-sm-12" ng-if="vm.user.address && !vm.user.payableAccountId">-->
      <!--<h1>Your account should be integrated with Dwolla service</h1>-->
      <!--<div class="row">-->
        <!--Start integration-->
      <!--</div>-->
    <!--</div>-->
    <div class="col-sm-12" ng-if="vm.user.address">
      <h1>New offer</h1>
      <uib-accordion>
        <uib-accordion-group heading="Event Details" is-open="false">
          <div class="row">
            <div class="col-sm-5">
              <div class="form-group">
                <label>Event Name</label>
                <span>{{vm.event.name}}</span>
              </div>
            </div>
            <div class="col-sm-7">
              <div class="form-group">
                <label>Description</label>
                <span>{{vm.event.description}}</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2">
              <div class="form-group">
                <label>Date</label>
                <span>{{vm.event.date | date: "longDate"}}</span>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <label>Time</label>
                <span>{{vm.event.time | date: "shortTime"}}</span>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group">
                <label>People</label>
                <span>{{vm.event.people}}</span>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group">
                <label>Price per person</label>
                <span>{{vm.event.pricePerPerson}}</span>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <label>Vegetarian Meals</label>
                <span>{{vm.event.vegetarianMeals}}</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-6">
              <div class="form-group">
                <label>Location</label>
                <span>{{vm.event.location}}</span>
              </div>
              <div class="form-group">
                <label>Delivery Instructions</label>
                <span>{{vm.event.deliveryInstructions}}</span>
              </div>
              <div class="form-group">
                <label>Special Request</label>
                <span>{{vm.event.specialRequest}}</span>
              </div>
            </div>
            <div class="col-sm-6">
              <label>Included in price</label>
              <ul>
                <li ng-repeat="iip in includedInPrice" ng-if="iip.checked">
                  {{iip.name}}
                </li>
              </ul>
            </div>
        </div>
        </uib-accordion-group>
      </uib-accordion>
      <h2>Create an offer</h2>
      <form class="form-fluid" name="form" novalidate>
        <input type="hidden" name="eventId" value="{{fm.eventId}}" />
        <div class="row">
          <div class="col-sm-3">
            <div class="form-group">
              <label>Price per person</label>
              <input type="text" name="pricePerPerson" disabled class="form-control" ng-model="fm.pricePerPerson">
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label>Counter</label>
              <div class="input-group">
                <input type="number" name="counter" class="form-control" ng-model="fm.counter">
                <span class="input-group-addon">$</span>
              </div>
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label>Counter Reason</label>
              <input type="text" name="counterReason" class="form-control" ng-model="fm.counterReason">
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-9">
            <div class="form-group">
              <label>Select Offer Template or Create New Offer</label>
              <templates></templates>
              <!--<textarea name="offerDescription" class="form-control" ng-model="fm.offerDescription"></textarea>-->
            </div>
          </div>
          <div class="col-sm-3">
            <label>Included in price</label>
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="checkbox" ng-repeat="iip in includedInPrice">
                  <label>
                    <input type="checkbox" checklist-model="fm.includedInPrice" checklist-value="iip._id" checked="iip.checked"> {{iip.name}}
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="form-group has-error">
          <p class="help-block" ng-show="form.name.$error.required && vm.submitted">
            Please enter the name of new Event.
          </p>
          <p class="help-block">{{ vm.errors.other }}</p>
        </div>
        <div ng-if="vm.saved" class="alert alert-success">Event is successfully saved</div>
        <div ng-if="vm.sent" class="alert alert-success">Event is successfully sent to restaurants</div>
        <div>
          <div>
            <button class="btn btn-primary" type="submit" ng-click="vm.sendRequest(form)"  ng-if="fm.status !== 'confirmed' && fm.status !== 'accepted' && fm.status !== 'cancelled' && !vm.sent">
              Send Offer
            </button>
            <button class="btn btn-inverse" ng-if="vm.sent || vm.cancelled || vm.confirmed" ng-click="vm.backToList()">Return to events list</button>
            <button class="btn btn-primary" type="submit" ng-click="vm.saveDraft(form)" ng-if="fm.status == 'draft'">
              Save Changes
            </button>
            <button class="btn btn-primary" type="submit" ng-click="vm.cancelChanges(form)"  ng-if="fm.status !== 'confirmed' && fm.status !== 'accepted' && fm.status !== 'cancelled'">
              Cancel Changes
            </button>
          </div>
        </div>
        <div></div>
      </form>
    </div>
  </div>
</div>
