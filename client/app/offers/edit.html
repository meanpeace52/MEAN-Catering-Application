<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <h1>Edit offer</h1>
      <!--<span class="label label-warning" ng-if="vm.event.isUpdated">Heads Up! Event is updated!</span>-->
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Event info</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-sm-5">
              <div class="form-group">
                <label>Event Name</label>
                <span>{{vm.event.name}}</span>
              </div>
            </div>
            <div class="col-sm-7">
              <div class="form-group">
                <label>Description</label>
                <span>{{vm.event.description}}</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-2">
              <div class="form-group">
                <label>Date</label>
                <span>{{vm.event.date | date: "longDate"}}</span>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <label>Time</label>
                <span>{{vm.event.time | date: "shortTime"}}</span>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group">
                <label>People</label>
                <span>{{vm.event.people}}</span>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group">
                <label>Price per person</label>
                <span>{{vm.event.pricePerPerson}}</span>
              </div>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <label>Vegetarian Meals</label>
                <span>{{vm.event.vegetarianMeals}}</span>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-6">
              <div class="form-group">
                <label>Location</label>
                <span>{{vm.event.location}}</span>
              </div>
              <div class="form-group">
                <label>Delivery Instructions</label>
                <span>{{vm.event.deliveryInstructions}}</span>
              </div>
              <div class="form-group">
                <label>Special Request</label>
                <span>{{vm.event.specialRequest}}</span>
              </div>
            </div>
            <div class="col-sm-6">
              <label>Included in price</label>
              <ul>
                <li ng-repeat="iip in includedInPrice" ng-if="iip.checked">
                  {{iip.name}}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div>
        <h2>Offer Details <span class="label label-info">{{fm.status}}</span></h2>
        <div ng-if="fm.status !== 'confirmed'">
          <hr />
          <button class="btn btn-success" ng-if="fm.status == 'accepted'" ng-click="vm.confirm(fm._id)">Confirm</button>
          <button class="btn btn-danger" ng-click="vm.cancel(fm._id)">Cancel Offer</button>
        </div>
        <div ng-if="vm.cancelled" class="alert alert-warning">Offer is cancelled.</div>
        <div ng-if="vm.confirmed" class="alert alert-success">Offer is confirmed.</div>
        <hr />
      </div>
      <form novalidate class="form-fluid" name="form">
        <input type="hidden" name="eventId" value="{{vm.eventId}}" />
        <input type="hidden" name="_id" value="{{fm._id}}" />
        <div class="row">
          <div class="col-sm-3">
            <div class="form-group">
              <label>Price per person</label>
              <input type="text" name="pricePerPerson" disabled class="form-control" ng-model="fm.pricePerPerson">
              <div ng-show>{{vm.reqired.pricePerPerson}}</div>
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label>Counter</label>
              <input type="text" name="counter" class="form-control" ng-model="fm.counter">
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label>Counter Reason</label>
              <input type="text" name="counterReason" class="form-control" ng-model="fm.counterReason">
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-6">
            <div class="form-group">
              <label>Offer description</label>
              <textarea name="offerDescription" class="form-control" ng-model="fm.offerDescription"></textarea>
            </div>
          </div>
          <div class="col-sm-6">
            <label>Included in price</label>
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="checkbox" ng-repeat="iip in includedInPrice">
                  <label>
                    <input type="checkbox" checklist-model="fm.includedInPrice" checklist-value="iip._id" checked="iip.checked"> {{iip.name}}
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="form-group has-error">
          <p class="help-block" ng-show="form.name.$error.required && vm.submitted">
            Please enter the name of new Event.
          </p>
          <p class="help-block">{{ vm.errors.other }}</p>
        </div>
        <div ng-if="vm.saved" class="alert alert-success">Offer is successfully saved.</div>
        <div ng-if="vm.sent" class="alert alert-success">Offer is successfully sent to Customer.</div>
        <div ng-if="fm.status == 'confirmed' || fm.status == 'accepted' || fm.status == 'cancelled'">
          <button class="btn btn-primary disabled" type="submit">
            Send Request
          </button>
        </div>
        <div ng-if="fm.status !== 'confirmed' && fm.status !== 'accepted' && fm.status !== 'cancelled'">
          <button class="btn btn-primary" type="submit" ng-click="vm.sendRequest(form)">
            Save Changes
          </button>
        </div>
        <div></div>
      </form>
    </div>
  </div>
</div>
