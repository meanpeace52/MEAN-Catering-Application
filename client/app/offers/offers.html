<div class="container" ng-if="eventId">
  <div class="row">
    <div class="col-sm-12">
      <h3 class="pull-left">Offers</h3>
      <!--<button class="btn btn-primary pull-right"  ng-if="oc.user.role == 'caterer'" ui-sref="newOffer">Edit offer</button>-->
    </div>
  </div>
  <div class="row">
    <div class="offers-pills">
      <uib-tabset active="activePill" vertical="true" type="pills">
        <uib-tab ng-repeat="offer in offers" heading="{{offer.catererName}}">
          <div class="panel panel-default" style="padding: 10px; background-color: #e7e7e7 ">
            <div class="row">
              <div class="col-sm-6">
                <h3>
                  <small>Offer from</small> <b>{{offer.catererName}}</b>
                </h3>
                <h3>
                  <small>Total price:</small> <b>${{offer.invoice.total}}</b> <span class="label label-info">{{offer.paymentStatus || offer.status}}</span>
                </h3>
              </div>
              <div class="col-sm-6" ng-if="!past">
                <div ng-if="offer.status == 'sent' && !offer.drafted">
                  <hr>
                  <button class="btn btn-success" ng-click="oc.accept(offer._id)">Accept</button>
                  <button class="btn btn-danger" ng-click="oc.decline(offer._id)">Decline</button>
                </div>
                <div ng-if="offer.paymentStatus === 'hold'">
                  <hr>
                  <a class="btn btn-success" ng-click="oc.capture(offer)">Pay</a>
                </div>
                <div ng-if="offer.status === 'confirmed' && !offer.paymentStatus">
                  <hr>
                  <a class="btn btn-success" ng-click="oc.auth(offer)">Hold</a>
                </div>
                <hr>
              </div>
            </div>
            <div class="row">
              <div class="container-fluid" ng-if="eventId" ng-class="{'cancelled-offer': offer.status === 'cancelled', 'drafted': offer.drafted}">
                <div class="row">
                  <div class="col-sm-6">
                    <p><b>Price per person:</b> ${{offer.pricePerPerson}}</p>
                    <p ng-if="offer.counter"><b>Counter:</b> ${{offer.counter}} </p>
                    <p >Subtotal: <b>${{offer.invoice.service}}</b> </p>
                    <p >Tax: <b>${{offer.invoice.tax}}</b> </p>
                    <p>Total: <b>${{offer.invoice.total}}</b> </p>
                    <p ng-if="offer.counterReason"><b>Counter Reason:</b> {{offer.counterReason}}</p>
                  </div>
                  <div class="col-sm-3" ng-if="offer.includedInPrice.length">
                    <p><b>Offer Included in price:</b></p>
                        <ul>
                          <li ng-repeat="iip in offer.includedInPrice">
                            {{iip.name}}
                          </li>
                        </ul>
                  </div>
                  <div class="col-sm-3" ng-if="event.includedInPrice.length">
                    <p><b>Event Included in price:</b></p>
                    <ul>
                      <li ng-repeat="iip in event.includedInPrice">
                        {{iip.name}}
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <p ng-if="offer.offerDescription"><b>Offer Description:</b> <p style="white-space: pre-wrap;">{{offer.offerDescription}}</p></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div style="padding: 10px;" offercomments offer="offer"></div>
            <hr>
          </div>
          <div class="row">
            <div class="col-sm-6">
              <div ng-if="offer.caterer.logo" class="img-thumbnail" width="300" ng-draw="{file: offer.caterer.logo, width: 300}"></div>
            </div>
            <div class="col-sm-6">
              <a ng-if="offer.caterer.website" href="/caterers/{{offer.catererId}}" class="label label-info m-3" target="_blank" style="font-size: 100%;">View Profile</a>
              <p></p>
              <p ng-if="offer.caterer.website"><b>Website:</b> <a href="http://{{offer.caterer.website}}" target="_blank">{{offer.caterer.website}}</a> </p>
              <p ng-if="offer.caterer.location"><b>Location:</b> {{offer.caterer.location}}</p>
              <p ng-if="offer.caterer.ninja_firstname"><b>Contact:</b> {{offer.caterer.ninja_firstname}} {{offer.caterer.ninja_lastname}}</p>
              <p ng-if="offer.caterer.ninja_firstname"><b>Contact Email:</b> {{offer.caterer.ninja_email}}</p>
              <p ng-if="offer.caterer.ninja_firstname"><b>Contact Phone:</b> {{offer.caterer.ninja_phone}}</p>
              <p ng-if="offer.caterer.description"><b>Description:</b> {{offer.caterer.description}}</p>
            </div>
          </div>
        </uib-tab>
      </uib-tabset>
    </div>
  </div>
</div>
<div class="container" ng-if="!eventId">
  <div class="row">
    <div class="col-sm-12">
      <h3>No Events Selected, Select and Event to See Offers</h3>
    </div>
  </div>
</div>
