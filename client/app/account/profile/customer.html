<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <h1>Profile</h1>
    </div>
    <div class="col-sm-12">
      <uib-tabset active="active">
        <uib-tab index="0" heading="Payments">
          <br />
          <div class="panel panel-default">
            <div class="panel-body">
              <table class="table table-condensed">
                <thead>
                <tr>
                  <th>Status</th>
                  <th>Date</th>
                  <th>Total</th>
                  <th>Event</th>
                  <th>Caterer</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="event in events">
                  <td>
                    <span class="label label-info">{{event.paymentStatus}}</span>
                  </td>
                  <td>
                    <span ng-if="event.paymentStatus == 'paid'">{{event.paymentPaidDate | date: "longDate" }}</span>
                    <span ng-if="event.paymentStatus == 'hold'">{{event.paymentHoldDate | date: "longDate" }}</span>
                  </td>
                  <td>{{event.offer.invoice.total}}</td>
                  <td>{{event.name}}</td>
                  <td>{{event.offer.catererName}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </uib-tab>
        <uib-tab index="1" heading="Profile">
          <br />
          <form class="form" name="form" ng-submit="vm.register(form)" novalidate>

            <div class="form-group" ng-class="{ 'has-success': form.name.$valid && vm.submitted,
                                                'has-error': form.name.$invalid && vm.submitted }">
              <label>First Name</label>

              <input type="text" name="firstname" class="form-control" ng-model="vm.user.firstname"
                     required/>
              <p class="help-block" ng-show="form.name.$error.required && vm.submitted">
                A name is required
              </p>
            </div>

            <div class="form-group" ng-class="{ 'has-success': form.name.$valid && vm.submitted,
                                                'has-error': form.name.$invalid && vm.submitted }">
              <label>Last Name</label>

              <input type="text" name="lastname" class="form-control" ng-model="vm.user.lastname"
                     required/>
              <p class="help-block" ng-show="form.name.$error.required && vm.submitted">
                A name is required
              </p>
            </div>

            <div class="form-group" ng-class="{ 'has-success': form.email.$valid && vm.submitted,
                                                'has-error': form.email.$invalid && vm.submitted }">
              <label>Email</label>

              <input type="email" name="email" class="form-control" ng-model="vm.user.email"
                     required
                     mongoose-error/>
              <p class="help-block" ng-show="form.email.$error.email && vm.submitted">
                Doesn't look like a valid email.
              </p>
              <p class="help-block" ng-show="form.email.$error.required && vm.submitted">
                What's your email address?
              </p>
              <p class="help-block" ng-show="form.email.$error.mongoose">
                {{ vm.errors.email }}
              </p>
            </div>
            <div class="alert alert-success" role="alert" ng-if="vm.saved">Account information is successfully saved</div>
            <div>
              <button class="btn btn-primary btn-lg btn-register" type="submit">
                Save Changes
              </button>
            </div>

          </form>
        </uib-tab>
        <uib-tab index="2" heading="Change password">
          <br />
          <form class="form" name="form" ng-submit="vm.changePassword(form)" novalidate>

            <div class="form-group">
              <label>Current Password</label>

              <input type="password" name="password" class="form-control" ng-model="vm.user.oldPassword"
                     mongoose-error/>
              <p class="help-block" ng-show="form.password.$error.mongoose">
                {{ vm.errors.other }}
              </p>
            </div>

            <div class="form-group">
              <label>New Password</label>

              <input type="password" name="newPassword" class="form-control" ng-model="vm.user.newPassword"
                     ng-minlength="3"
                     required/>
              <p class="help-block"
                 ng-show="(form.newPassword.$error.minlength || form.newPassword.$error.required) && (form.newPassword.$dirty || vm.submitted)">
                Password must be at least 3 characters.
              </p>
            </div>

            <div class="form-group">
              <label>Confirm New Password</label>

              <input type="password" name="confirmPassword" class="form-control" ng-model="vm.user.confirmPassword"
                     match="vm.user.newPassword"
                     ng-minlength="3"
                     required=""/>
              <p class="help-block"
                 ng-show="form.confirmPassword.$error.match && vm.submitted">
                Passwords must match.
              </p>

            </div>

            <p class="help-block"> {{ vm.message }} </p>
            <div class="alert alert-success" role="alert" ng-if="vm.saved">Account information is successfully saved</div>
            <button class="btn btn-lg btn-primary" type="submit">Save changes</button>
          </form>
        </uib-tab>
      </uib-tabset>
    </div>
  </div>
  <hr>
</div>
